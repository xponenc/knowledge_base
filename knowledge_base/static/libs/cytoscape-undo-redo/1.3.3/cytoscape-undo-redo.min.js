/**
 * Minified by jsDelivr using Terser v5.37.0.
 * Original file: /npm/cytoscape-undo-redo@1.3.3/cytoscape-undo-redo.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(){"use strict";var n=function(n){function o(n,o){void 0===n.scratch("_undoRedo")&&n.scratch("_undoRedo",{});var e=n.scratch("_undoRedo");return void 0===o?e:e[o]}function e(n,e,t){var i=o(n);i[e]=t,n.scratch("_undoRedo",i)}n&&n("core","undoRedo",(function(n,t){var i=this,r=o(i,"instance")||function(n){var o={options:{isDebug:!1,actions:{},undoableDrag:!0,stackSizeLimit:void 0,beforeUndo:function(){},afterUndo:function(){},beforeRedo:function(){},afterRedo:function(){},ready:function(){}},actions:{},undoStack:[],redoStack:[],reset:function(n,o){this.undoStack=n||[],this.redoStack=o||[]},undo:function(){if(!this.isUndoStackEmpty()){var o=this.undoStack.pop();n.trigger("beforeUndo",[o.name,o.args]);var e=this.actions[o.name]._undo(o.args);return this.redoStack.push({name:o.name,args:e}),n.trigger("afterUndo",[o.name,o.args,e]),e}this.options.isDebug&&console.log("Undoing cannot be done because undo stack is empty!")},redo:function(){if(!this.isRedoStackEmpty()){var o=this.redoStack.pop();n.trigger(o.firstTime?"beforeDo":"beforeRedo",[o.name,o.args]),o.args||(o.args={}),o.args.firstTime=!!o.firstTime;var e=this.actions[o.name]._do(o.args);return this.undoStack.push({name:o.name,args:e}),null!=this.options.stackSizeLimit&&this.undoStack.length>this.options.stackSizeLimit&&this.undoStack.shift(),n.trigger(o.firstTime?"afterDo":"afterRedo",[o.name,o.args,e]),e}this.options.isDebug&&console.log("Redoing cannot be done because redo stack is empty!")},do:function(n,o){return this.redoStack.length=0,this.redoStack.push({name:n,args:o,firstTime:!0}),this.redo()},undoAll:function(){for(;!this.isUndoStackEmpty();)this.undo()},redoAll:function(){for(;!this.isRedoStackEmpty();)this.redo()},action:function(n,o,e){return this.actions[n]={_do:o,_undo:e},this},removeAction:function(n){delete this.actions[n]},isUndoStackEmpty:function(){return 0===this.undoStack.length},isRedoStackEmpty:function(){return 0===this.redoStack.length},getUndoStack:function(){return this.undoStack},getRedoStack:function(){return this.redoStack}};return o}(i);if(e(i,"instance",r),n){for(var s in n)r.options.hasOwnProperty(s)&&(r.options[s]=n[s]);if(n.actions)for(var s in n.actions)r.actions[s]=n.actions[s]}if(!o(i,"isInitialized")&&!t){var a=function(n){function e(n){for(var o={},e=0;e<n.length;e++)o[n[e].id()]=!0;var t=n.filter((function(n,e){"number"==typeof n&&(n=e);for(var t=n.parent()[0];null!=t;){if(o[t.id()])return!1;t=t.parent()[0]}return!0}));return t}function t(n,o,i){for(var r=i?o:e(o),s=0;s<r.length;s++){var a=r[s],d=a.position("x"),u=a.position("y");a.isParent()||a.position({x:d+n.x,y:u+n.y}),t(n,a.children(),!0)}}function i(o){return"string"==typeof o?n.$(o):o}function r(n){return i(n).restore()}function s(o){var e={};return n.nodes().not(":parent").positions((function(n,t){"number"==typeof n&&(n=t),e[n.id()]={x:n.position("x"),y:n.position("y")};var i=o[n.id()];return{x:i.x,y:i.y}})),e}function a(){for(var o={},e=n.nodes(),t=0;t<e.length;t++){var i=e[t];o[i.id()]={x:i.position("x"),y:i.position("y")}}return o}function d(n){var o={};if(n.firstTime){var e=null==n.parentData?null:n.parentData,i=n.nodes.union(n.nodes.descendants());o.elesToRestore=i.union(i.connectedEdges()),o.movedEles=n.nodes.move({parent:e}),t({x:n.posDiffX,y:n.posDiffY},o.movedEles)}else o.elesToRestore=n.movedEles.remove(),o.movedEles=n.elesToRestore.restore();return n.callback&&(o.callback=n.callback,n.callback(o.movedEles)),o}function u(n){var o={};if(n.firstTime){var e=null==n.parentData?null:n.parentData,i=n.nodes.union(n.nodes.descendants()),r={};i.forEach((function(n){n.parent().id()?r[n.id()]=n.parent():r[n.id()]=null}));var s={};i.forEach((function(n){s[n.id()]={},s[n.id()].x=n.position("x"),s[n.id()].y=n.position("y")})),o.oldParent=r,o.oldPosition=s,o.newParent=e,o.movedEles=i,n.nodes.move({parent:e}).nodes(),t({x:n.posDiffX,y:n.posDiffY},o.movedEles)}else o.oldParent={},n.movedEles.forEach((function(n){n.parent().id()?o.oldParent[n.id()]=n.parent():o.oldParent[n.id()]=null})),o.oldPosition={},n.movedEles.forEach((function(n){o.oldPosition[n.id()]={},o.oldPosition[n.id()].x=n.position("x"),o.oldPosition[n.id()].y=n.position("y")})),o.newParent=n.oldParent,o.movedEles=n.movedEles,o.movedEles.forEach((function(e){"object"!=typeof o.newParent?e.move({parent:o.newParent}):null==o.newParent[e.id()]?e.move({parent:null}):e.move({parent:o.newParent[e.id()].id()}),e.position(n.oldPosition[e.id()])}));return n.callback&&(o.callback=n.callback,n.callback(o.movedEles)),o}function c(e,t){for(var i=[],r=o(n,"instance").actions,s=0;s<e.length;s++){var a=e[s];if(!r.hasOwnProperty(a.name))throw"Action "+a.name+" does not exist as an undoable function"}for(s=0;s<e.length;s++){var d;(a=e[s]).param.firstTime=e.firstTime,d="undo"==t?r[a.name]._undo(a.param):r[a.name]._do(a.param),i.unshift({name:a.name,param:d})}return i}return{add:{_do:function(o){return o.firstTime?n.add(o):r(o)},_undo:n.remove},remove:{_do:n.remove,_undo:r},restore:{_do:r,_undo:n.remove},select:{_do:function(n){return i(n).select()},_undo:function(n){return i(n).unselect()}},unselect:{_do:function(n){return i(n).unselect()},_undo:function(n){return i(n).select()}},move:{_do:function(n){var o=i(n.eles),e=o.nodes(),t=o.edges(),r=[],s=[],a=[];return e.forEach((function(n){r.push(n.parent().length>1?n.parent().id():null)})),t.forEach((function(n){s.push(n.source().id()),a.push(n.target().id())})),{oldNodesParents:r,newNodes:e.move(n.location),oldEdgesSources:s,oldEdgesTargets:a,newEdges:t.move(n.location)}},_undo:function(o){var e=n.collection(),t={};if(o.newNodes.length>0){t.parent=o.newNodes[0].parent().id();for(var i=0;i<o.newNodes.length;i++){var r=o.newNodes[i].move({parent:o.oldNodesParents[i]});e=e.union(r)}}else{t.source=o.newEdges[0].source().id(),t.target=o.newEdges[0].target().id();for(i=0;i<o.newEdges.length;i++){var s=o.newEdges[i].move({source:o.oldEdgesSources[i],target:o.oldEdgesTargets[i]});e=e.union(s)}}return{eles:e,location:t}}},drag:{_do:function(o){return o.move&&(t(o.positionDiff,o.nodes),n.elements().unselect()),o},_undo:function(o){var e={x:-1*o.positionDiff.x,y:-1*o.positionDiff.y},i={positionDiff:o.positionDiff,nodes:o.nodes,move:!0};return t(e,o.nodes),n.elements().unselect(),i}},layout:{_do:function(o){if(o.firstTime){var e,t=a();return(e=o.eles?i(o.eles).layout(o.options):n.layout(o.options))&&e.run&&e.run(),t}return s(o)},_undo:function(n){return s(n)}},changeParent:{_do:function(o){return n.nodes()[0].component?u(o):d(o)},_undo:function(o){return n.nodes()[0].component?u(o):d(o)}},batch:{_do:function(n){return c(n,"do")},_undo:function(n){return c(n,"undo")}}}}(i);for(var s in a)r.actions[s]=a[s];!function(n,e){var t=null;n.on("grab","node",(function(){("function"==typeof e?e.call(this):e)&&((t={}).lastMouseDownPosition={x:this.position("x"),y:this.position("y")},t.node=this)})),n.on("free","node",(function(){var i=o(n,"instance");if("function"==typeof e?e.call(this):e){if(null==t)return;var r=t.node,s=t.lastMouseDownPosition,a={x:r.position("x"),y:r.position("y")};if(a.x!=s.x||a.y!=s.y){var d={positionDiff:{x:a.x-s.x,y:a.y-s.y},nodes:r.selected()?n.nodes(":visible").filter(":selected"):n.collection([r]),move:!1};i.do("drag",d),t=null}}}))}(i,r.options.undoableDrag),e(i,"isInitialized",!0)}return r.options.ready(),r}))};"undefined"!=typeof module&&module.exports&&(module.exports=n),"undefined"!=typeof define&&define.amd&&define("cytoscape.js-undo-redo",(function(){return n})),"undefined"!=typeof cytoscape&&n(cytoscape)}();
//# sourceMappingURL=/sm/b0c3778520ae1a6945c12b2c172efeb780ad281130fcb383a763bb23e2acf34c.map   